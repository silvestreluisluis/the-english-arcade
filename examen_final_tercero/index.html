<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Juego de Práctica de Inglés</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f5f7fa;
            color: #333;
            padding: 20px;
            line-height: 1.6;
        }
        
        .container {
            max-width: 900px;
            margin: 0 auto;
            background-color: white;
            border-radius: 15px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
            padding: 30px;
        }
        
        header {
            text-align: center;
            margin-bottom: 30px;
            border-bottom: 2px solid #4a6fa5;
            padding-bottom: 20px;
        }
        
        h1 {
            color: #2c3e50;
            margin-bottom: 10px;
        }
        
        .subtitle {
            color: #7f8c8d;
            font-size: 1.1rem;
        }
        
        .buttons-section {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }
        
        .section-btn {
            padding: 12px 25px;
            font-size: 1rem;
            font-weight: 600;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            background-color: #ecf0f1;
            color: #2c3e50;
        }
        
        .section-btn.active {
            background-color: #3498db;
            color: white;
        }
        
        .section-btn:disabled {
            background-color: #bdc3c7;
            cursor: not-allowed;
            color: #7f8c8d;
        }
        
        .section-btn.enabled:hover:not(.active) {
            background-color: #3498db;
            color: white;
        }
        
        .game-section {
            display: none;
            padding: 20px;
            border-radius: 10px;
            background-color: #f9f9f9;
            margin-bottom: 20px;
        }
        
        .game-section.active {
            display: block;
        }
        
        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 1px solid #ddd;
        }
        
        .section-title {
            font-size: 1.4rem;
            color: #2c3e50;
        }
        
        .progress {
            font-weight: 600;
            color: #3498db;
        }
        
        .question-container {
            margin-bottom: 25px;
            padding: 20px;
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
        }
        
        .sentence {
            font-size: 1.2rem;
            margin-bottom: 15px;
            padding: 15px;
            background-color: #f8f9fa;
            border-left: 4px solid #3498db;
            border-radius: 5px;
        }
        
        .error-sentence {
            color: #e74c3c;
            font-style: italic;
        }
        
        .hint {
            font-size: 0.9rem;
            color: #e67e22;
            margin-bottom: 15px;
            padding: 8px 12px;
            background-color: #fef5e7;
            border-radius: 5px;
        }
        
        .input-container {
            margin-top: 15px;
        }
        
        .correction-input {
            width: 100%;
            padding: 12px;
            font-size: 1rem;
            border: 2px solid #ddd;
            border-radius: 5px;
            margin-bottom: 10px;
        }
        
        .correction-input:focus {
            border-color: #3498db;
            outline: none;
        }
        
        .correction-input.error {
            border-color: #e74c3c;
            background-color: #fef5f5;
        }
        
        .input-error {
            color: #e74c3c;
            font-size: 0.85rem;
            margin-top: 5px;
            display: none;
        }
        
        .feedback {
            padding: 10px;
            border-radius: 5px;
            margin-top: 10px;
            display: none;
            font-weight: 600;
        }
        
        .correct {
            background-color: #d5f4e6;
            color: #27ae60;
            border: 1px solid #2ecc71;
        }
        
        .incorrect {
            background-color: #fadbd8;
            color: #c0392b;
            border: 1px solid #e74c3c;
        }
        
        .btn {
            padding: 10px 20px;
            background-color: #3498db;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: 600;
            transition: background-color 0.3s;
        }
        
        .btn:hover {
            background-color: #2980b9;
        }
        
        .btn:disabled {
            background-color: #bdc3c7;
            cursor: not-allowed;
        }
        
        .multiple-choice {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin-top: 15px;
        }
        
        .choice {
            padding: 12px;
            background-color: white;
            border: 2px solid #ddd;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .choice:hover {
            background-color: #f0f8ff;
            border-color: #3498db;
        }
        
        .choice.selected {
            background-color: #3498db;
            color: white;
            border-color: #2980b9;
        }
        
        .choice.correct-choice {
            background-color: #2ecc71;
            color: white;
            border-color: #27ae60;
        }
        
        .choice.incorrect-choice {
            background-color: #e74c3c;
            color: white;
            border-color: #c0392b;
        }
        
        .pairs-container {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 15px;
            margin-top: 20px;
        }
        
        .card {
            height: 100px;
            background-color: #3498db;
            color: white;
            display: flex;
            justify-content: center;
            align-items: center;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            text-align: center;
            padding: 10px;
            transition: transform 0.3s;
        }
        
        .card:hover {
            transform: scale(1.03);
        }
        
        .card.flipped {
            background-color: #2c3e50;
        }
        
        .card.matched {
            background-color: #27ae60;
            cursor: default;
        }
        
        .timer {
            font-size: 1.5rem;
            font-weight: bold;
            color: #e74c3c;
            text-align: center;
            margin: 15px 0;
        }
        
        .results {
            text-align: center;
            padding: 30px;
            background-color: #f9f9f9;
            border-radius: 10px;
            margin-top: 20px;
            display: none;
        }
        
        .results.active {
            display: block;
        }
        
        .score {
            font-size: 2.5rem;
            font-weight: bold;
            color: #2c3e50;
            margin: 20px 0;
        }
        
        .score-grade {
            font-size: 3rem;
            color: #3498db;
            margin-bottom: 20px;
        }
        
        .section-scores {
            display: flex;
            justify-content: space-around;
            margin-top: 30px;
            flex-wrap: wrap;
        }
        
        .section-score {
            background-color: white;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            min-width: 150px;
            margin: 10px;
        }
        
        .restart-btn {
            margin-top: 20px;
            background-color: #2ecc71;
        }
        
        .restart-btn:hover {
            background-color: #27ae60;
        }
        
        @media (max-width: 768px) {
            .multiple-choice {
                grid-template-columns: 1fr;
            }
            
            .pairs-container {
                grid-template-columns: repeat(3, 1fr);
            }
            
            .buttons-section {
                flex-direction: column;
            }
            
            .section-btn {
                width: 100%;
            }
        }
        
        @media (max-width: 480px) {
            .pairs-container {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .container {
                padding: 15px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Juego de Práctica de Inglés</h1>
            <p class="subtitle">Mejora tu inglés corrigiendo oraciones, identificando tiempos verbales y encontrando pares de palabras</p>
        </header>
        
        <div class="buttons-section">
            <button id="btn-correction" class="section-btn active">1. Corrección</button>
            <button id="btn-identification" class="section-btn" disabled>2. Identificación</button>
            <button id="btn-pairs" class="section-btn" disabled>3. Pares</button>
        </div>
        
        <!-- Sección 1: Corrección de oraciones -->
        <section id="correction-section" class="game-section active">
            <div class="section-header">
                <h2 class="section-title">Corrección de Oraciones</h2>
                <div class="progress">Pregunta <span id="correction-current">1</span> de 40</div>
            </div>
            
            <div class="question-container">
                <div class="sentence">
                    <span id="error-sentence"></span>
                </div>
                <div class="hint" id="hint"></div>
                
                <div class="input-container">
                    <input type="text" id="correction-input" class="correction-input" placeholder="Escribe la oración corregida aquí...">
                    <div id="input-error" class="input-error"></div>
                    <div id="correction-feedback" class="feedback"></div>
                </div>
            </div>
            
            <div style="text-align: center;">
                <button id="check-correction" class="btn">Comprobar</button>
                <button id="next-correction" class="btn" disabled>Siguiente</button>
            </div>
        </section>
        
        <!-- Sección 2: Identificación de tiempos verbales -->
        <section id="identification-section" class="game-section">
            <div class="section-header">
                <h2 class="section-title">Identificación de Tiempos Verbales</h2>
                <div class="progress">Pregunta <span id="identification-current">1</span> de 15</div>
            </div>
            
            <div class="question-container">
                <div class="sentence" id="identification-sentence"></div>
                
                <div class="multiple-choice" id="choices-container">
                    <!-- Las opciones se generan dinámicamente -->
                </div>
                
                <div id="identification-feedback" class="feedback"></div>
            </div>
            
            <div style="text-align: center;">
                <button id="check-identification" class="btn" disabled>Comprobar</button>
                <button id="next-identification" class="btn" disabled>Siguiente</button>
            </div>
        </section>
        
        <!-- Sección 3: Juego de pares -->
        <section id="pairs-section" class="game-section">
            <div class="section-header">
                <h2 class="section-title">Encuentra los Pares</h2>
                <div class="progress">Pares encontrados: <span id="pairs-found">0</span> de 10</div>
            </div>
            
            <div class="timer" id="timer">04:00</div>
            <p>Encuentra las parejas de palabras o frases que se usan para referirse al futuro. ¡Tienes 4 minutos!</p>
            
            <div class="pairs-container" id="pairs-container">
                <!-- Las cartas se generan dinámicamente -->
            </div>
            
            <div style="text-align: center; margin-top: 20px;">
                <button id="start-pairs" class="btn">Comenzar Juego</button>
            </div>
        </section>
        
        <!-- Sección de resultados -->
        <section id="results-section" class="results">
            <h2 class="section-title">Resultados Finales</h2>
            <div class="score-grade" id="final-grade">0.0</div>
            <div class="score">Calificación: <span id="final-score">0</span>/100</div>
            
            <div class="section-scores">
                <div class="section-score">
                    <h3>Corrección</h3>
                    <div class="score" id="correction-score">0/40</div>
                </div>
                <div class="section-score">
                    <h3>Identificación</h3>
                    <div class="score" id="identification-score">0/15</div>
                </div>
                <div class="section-score">
                    <h3>Pares</h3>
                    <div class="score" id="pairs-score">0/10</div>
                </div>
            </div>
            
            <button id="restart-game" class="btn restart-btn">Jugar Nuevamente</button>
        </section>
    </div>

    <script>
        // Variables del juego
        let currentSection = 'correction';
        let correctionQuestions = [];
        let identificationQuestions = [];
        let pairs = [];
        
        // Puntajes
        let correctionScore = 0;
        let identificationScore = 0;
        let pairsScore = 0;
        
        // Variables de control
        let currentCorrectionQuestion = 0;
        let currentIdentificationQuestion = 0;
        let selectedChoice = null;
        let correctionCompleted = false;
        let identificationCompleted = false;
        let pairsCompleted = false;
        
        // Variables para el juego de pares
        let flippedCards = [];
        let matchedPairs = 0;
        let gameStarted = false;
        let timeLeft = 240; // 4 minutos = 240 segundos
        let timerInterval = null;
        
        // Lista de verbos proporcionada
        const verbs = [
            'Speed', 'Feed', 'Stink', 'Bet', 'Lean', 'Creep', 'Kneel', 'Throw', 'Sweep', 'Drink',
            'Fall', 'Sing', 'Dig', 'Catch', 'Take', 'Hang', 'Swing', 'Eat', 'Buy', 'Drive',
            'Keep', 'Run', 'Cut', 'Sew', 'Cost', 'Grow', 'Give', 'Say', 'Tell', 'Leave',
            'Act', 'Add', 'Ask', 'Answer', 'Arrive', 'Brush', 'Belong', 'Beg', 'Believe', 'Close',
            'Cook', 'Call', 'Change', 'Clean', 'Cry', 'Dance', 'Dress', 'Die', 'Dry', 'Enjoy',
            'Explain', 'Follow', 'Finish', 'Help', 'Hope', 'Happen', 'Imagine', 'Kiss', 'Kill', 'Laugh'
        ];
        
        // Tiempos verbales para la sección de identificación
        const verbTenses = [
            'Verbo modal: would',
            'Presente continuo del verbo to be',
            'Presente continuo para el futuro',
            'Pasado participio',
            'Pasado continuo del verbo to be',
            'Pasado simple'
        ];
        
        // Frases para el juego de pares (futuro)
        const futurePhrases = [
            ['en un mes', 'in a month'],
            ['en dos minutos', 'in two minutes'],
            ['mañana', 'tomorrow'],
            ['la próxima semana', 'next week'],
            ['en un año', 'in a year'],
            ['dentro de poco', 'soon'],
            ['esta tarde', 'this afternoon'],
            ['el próximo lunes', 'next Monday'],
            ['en el futuro', 'in the future'],
            ['más tarde', 'later']
        ];
        
        // Oraciones para la sección de corrección (60 oraciones)
        const correctionSentences = [
            // 10 oraciones con verbo modal: would - CORREGIDAS CON ESTRUCTURA CORRECTA
            { 
                sentence: "I would to go to the cinema yesterday.", 
                correct: "I would go to the cinema yesterday.",
                hint: "Revisa la forma del verbo después de 'would'",
                tense: "Verbo modal: would"
            },
            { 
                sentence: "She would not eats the cake.", 
                correct: "She would not eat the cake.",
                hint: "Observa la forma del verbo principal",
                tense: "Verbo modal: would"
            },
            { 
                sentence: "Would you helps me with this box?", 
                correct: "Would you help me with this box?",
                hint: "Revisa la terminación del verbo",
                tense: "Verbo modal: would"
            },
            { 
                sentence: "They would bought a new car if they had money.", 
                correct: "They would buy a new car if they had money.",
                hint: "El verbo después de 'would' tiene una forma especial",
                tense: "Verbo modal: would"
            },
            { 
                sentence: "We would not went to the party last night.", 
                correct: "We would not go to the party last night.",
                hint: "El verbo después de 'would not' cambia",
                tense: "Verbo modal: would"
            },
            { 
                sentence: "Would she comes with us to the beach?", 
                correct: "Would she come with us to the beach?",
                hint: "Revisa la forma del verbo en preguntas con 'would'",
                tense: "Verbo modal: would"
            },
            { 
                sentence: "He would calls his mother every day.", 
                correct: "He would call his mother every day.",
                hint: "El verbo principal necesita ajuste",
                tense: "Verbo modal: would"
            },
            { 
                sentence: "I would not to travel alone.", 
                correct: "I would not travel alone.",
                hint: "Hay un elemento extra que no necesita estar ahí",
                tense: "Verbo modal: would"
            },
            { 
                sentence: "Would they visits us next summer?", 
                correct: "Would they visit us next summer?",
                hint: "Revisa la terminación del verbo principal",
                tense: "Verbo modal: would"
            },
            { 
                sentence: "She would buys groceries every Saturday.", 
                correct: "She would buy groceries every Saturday.",
                hint: "La forma del verbo necesita un pequeño cambio",
                tense: "Verbo modal: would"
            },
            
            // 10 oraciones en presente continuo del verbo to be
            { 
                sentence: "I am study for the exam right now.", 
                correct: "I am studying for the exam right now.",
                hint: "El verbo necesita una terminación especial",
                tense: "Presente continuo del verbo to be"
            },
            { 
                sentence: "She is not watch TV at the moment.", 
                correct: "She is not watching TV at the moment.",
                hint: "Falta algo en la forma del verbo",
                tense: "Presente continuo del verbo to be"
            },
            { 
                sentence: "Are you listen to me?", 
                correct: "Are you listening to me?",
                hint: "Revisa la forma del verbo en esta pregunta",
                tense: "Presente continuo del verbo to be"
            },
            { 
                sentence: "They are play football in the park.", 
                correct: "They are playing football in the park.",
                hint: "El verbo necesita un pequeño cambio",
                tense: "Presente continuo del verbo to be"
            },
            { 
                sentence: "He is not work today because he is sick.", 
                correct: "He is not working today because he is sick.",
                hint: "La forma del verbo no es completa",
                tense: "Presente continuo del verbo to be"
            },
            { 
                sentence: "Is she cook dinner for us?", 
                correct: "Is she cooking dinner for us?",
                hint: "Revisa la terminación del verbo",
                tense: "Presente continuo del verbo to be"
            },
            { 
                sentence: "We are not go to the concert tonight.", 
                correct: "We are not going to the concert tonight.",
                hint: "El verbo necesita una terminación diferente",
                tense: "Presente continuo del verbo to be"
            },
            { 
                sentence: "Are they wait for the bus?", 
                correct: "Are they waiting for the bus?",
                hint: "Falta algo en la forma verbal",
                tense: "Presente continuo del verbo to be"
            },
            { 
                sentence: "It is rain a lot this week.", 
                correct: "It is raining a lot this week.",
                hint: "El verbo necesita una pequeña modificación",
                tense: "Presente continuo del verbo to be"
            },
            { 
                sentence: "I am not sleep well these days.", 
                correct: "I am not sleeping well these days.",
                hint: "La forma del verbo no es la correcta para este tiempo",
                tense: "Presente continuo del verbo to be"
            },
            
            // 10 oraciones presente continuo para el futuro
            { 
                sentence: "I am meet my friends tomorrow evening.", 
                correct: "I am meeting my friends tomorrow evening.",
                hint: "Revisa la forma del verbo para expresar planes futuros",
                tense: "Presente continuo para el futuro"
            },
            { 
                sentence: "She is not travel next week.", 
                correct: "She is not traveling next week.",
                hint: "El verbo necesita una terminación especial",
                tense: "Presente continuo para el futuro"
            },
            { 
                sentence: "Are you leave on Friday?", 
                correct: "Are you leaving on Friday?",
                hint: "Falta algo en la forma verbal para futuro",
                tense: "Presente continuo para el futuro"
            },
            { 
                sentence: "They are have a party next Saturday.", 
                correct: "They are having a party next Saturday.",
                hint: "La forma del verbo no es apropiada para planes",
                tense: "Presente continuo para el futuro"
            },
            { 
                sentence: "He is start a new job in September.", 
                correct: "He is starting a new job in September.",
                hint: "Revisa la terminación del verbo",
                tense: "Presente continuo para el futuro"
            },
            { 
                sentence: "Is she visit her grandparents this weekend?", 
                correct: "Is she visiting her grandparents this weekend?",
                hint: "El verbo necesita un pequeño cambio para futuro",
                tense: "Presente continuo para el futuro"
            },
            { 
                sentence: "We are not move to a new house next month.", 
                correct: "We are not moving to a new house next month.",
                hint: "Falta algo en la forma verbal",
                tense: "Presente continuo para el futuro"
            },
            { 
                sentence: "Are they arrive at 8 PM?", 
                correct: "Are they arriving at 8 PM?",
                hint: "La forma del verbo no es la correcta para este contexto",
                tense: "Presente continuo para el futuro"
            },
            { 
                sentence: "I am take a vacation in July.", 
                correct: "I am taking a vacation in July.",
                hint: "Revisa la terminación del verbo para planes",
                tense: "Presente continuo para el futuro"
            },
            { 
                sentence: "She is not work on Monday.", 
                correct: "She is not working on Monday.",
                hint: "El verbo necesita una pequeña modificación",
                tense: "Presente continuo para el futuro"
            },
            
            // 10 oraciones en pasado participio
            { 
                sentence: "I have never see that movie before.", 
                correct: "I have never seen that movie before.",
                hint: "El verbo necesita una forma diferente",
                tense: "Pasado participio"
            },
            { 
                sentence: "She has not finish her homework yet.", 
                correct: "She has not finished her homework yet.",
                hint: "Falta algo en la forma del verbo",
                tense: "Pasado participio"
            },
            { 
                sentence: "Have you ever eat sushi?", 
                correct: "Have you ever eaten sushi?",
                hint: "Revisa la forma del verbo en esta estructura",
                tense: "Pasado participio"
            },
            { 
                sentence: "They have live in this city for five years.", 
                correct: "They have lived in this city for five years.",
                hint: "El verbo necesita un pequeño cambio",
                tense: "Pasado participio"
            },
            { 
                sentence: "He has not spoke to his boss about the problem.", 
                correct: "He has not spoken to his boss about the problem.",
                hint: "La forma del verbo no es la correcta aquí",
                tense: "Pasado participio"
            },
            { 
                sentence: "Have we meet before?", 
                correct: "Have we met before?",
                hint: "Revisa la forma del verbo en preguntas",
                tense: "Pasado participio"
            },
            { 
                sentence: "I have never be to Paris.", 
                correct: "I have never been to Paris.",
                hint: "Este verbo tiene una forma especial en este tiempo",
                tense: "Pasado participio"
            },
            { 
                sentence: "She has not do the laundry.", 
                correct: "She has not done the laundry.",
                hint: "El verbo necesita una forma diferente",
                tense: "Pasado participio"
            },
            { 
                sentence: "Have they leave already?", 
                correct: "Have they left already?",
                hint: "Revisa la forma del verbo",
                tense: "Pasado participio"
            },
            { 
                sentence: "We have not hear that song in years.", 
                correct: "We have not heard that song in years.",
                hint: "El verbo necesita un pequeño cambio",
                tense: "Pasado participio"
            },
            
            // 10 oraciones en pasado continuo del verbo to be
            { 
                sentence: "I was watch TV when you called.", 
                correct: "I was watching TV when you called.",
                hint: "Falta algo en la forma del verbo",
                tense: "Pasado continuo del verbo to be"
            },
            { 
                sentence: "They were not listen to the teacher.", 
                correct: "They were not listening to the teacher.",
                hint: "El verbo necesita una terminación especial",
                tense: "Pasado continuo del verbo to be"
            },
            { 
                sentence: "Was she sleep when you arrived?", 
                correct: "Was she sleeping when you arrived?",
                hint: "Revisa la forma del verbo en preguntas pasadas",
                tense: "Pasado continuo del verbo to be"
            },
            { 
                sentence: "He was drive to work when the accident happened.", 
                correct: "He was driving to work when the accident happened.",
                hint: "La forma del verbo no es completa",
                tense: "Pasado continuo del verbo to be"
            },
            { 
                sentence: "We were not study at that time.", 
                correct: "We were not studying at that time.",
                hint: "El verbo necesita una pequeña modificación",
                tense: "Pasado continuo del verbo to be"
            },
            { 
                sentence: "Were you work all night?", 
                correct: "Were you working all night?",
                hint: "Falta algo en la forma verbal",
                tense: "Pasado continuo del verbo to be"
            },
            { 
                sentence: "It was rain heavily yesterday afternoon.", 
                correct: "It was raining heavily yesterday afternoon.",
                hint: "Revisa la terminación del verbo",
                tense: "Pasado continuo del verbo to be"
            },
            { 
                sentence: "They were wait for the bus for an hour.", 
                correct: "They were waiting for the bus for an hour.",
                hint: "El verbo necesita un cambio pequeño",
                tense: "Pasado continuo del verbo to be"
            },
            { 
                sentence: "Was he talk to his friend?", 
                correct: "Was he talking to his friend?",
                hint: "La forma del verbo no es apropiada",
                tense: "Pasado continuo del verbo to be"
            },
            { 
                sentence: "I was not cook dinner last night.", 
                correct: "I was not cooking dinner last night.",
                hint: "Revisa la forma del verbo en negativo pasado",
                tense: "Pasado continuo del verbo to be"
            },
            
            // 10 oraciones en pasado simple
            { 
                sentence: "I go to the store yesterday.", 
                correct: "I went to the store yesterday.",
                hint: "El verbo necesita la forma de pasado",
                tense: "Pasado simple"
            },
            { 
                sentence: "She did not ate breakfast this morning.", 
                correct: "She did not eat breakfast this morning.",
                hint: "Revisa la forma del verbo después de 'did not'",
                tense: "Pasado simple"
            },
            { 
                sentence: "Did you saw that movie last week?", 
                correct: "Did you see that movie last week?",
                hint: "El verbo en preguntas con 'did' tiene una forma especial",
                tense: "Pasado simple"
            },
            { 
                sentence: "They buy a new car last year.", 
                correct: "They bought a new car last year.",
                hint: "Este verbo necesita su forma de pasado",
                tense: "Pasado simple"
            },
            { 
                sentence: "He did not went to school yesterday.", 
                correct: "He did not go to school yesterday.",
                hint: "Revisa la forma del verbo en negativo",
                tense: "Pasado simple"
            },
            { 
                sentence: "Did she called you last night?", 
                correct: "Did she call you last night?",
                hint: "La forma del verbo en preguntas necesita ajuste",
                tense: "Pasado simple"
            },
            { 
                sentence: "We take a taxi to the airport.", 
                correct: "We took a taxi to the airport.",
                hint: "Este verbo irregular necesita su forma pasada",
                tense: "Pasado simple"
            },
            { 
                sentence: "I did not understand the question.", 
                correct: "I did not understand the question.",
                hint: "Esta oración es correcta, solo verifica la puntuación",
                tense: "Pasado simple"
            },
            { 
                sentence: "Did they arrived on time?", 
                correct: "Did they arrive on time?",
                hint: "Revisa la forma del verbo después de 'did'",
                tense: "Pasado simple"
            },
            { 
                sentence: "She make a delicious cake for the party.", 
                correct: "She made a delicious cake for the party.",
                hint: "El verbo necesita su forma de pasado",
                tense: "Pasado simple"
            }
        ];
        
        // Oraciones para la sección de identificación (15 oraciones)
        const identificationSentences = [
            { sentence: "I would help you if I had more time.", tense: "Verbo modal: would" },
            { sentence: "She is studying for her exam right now.", tense: "Presente continuo del verbo to be" },
            { sentence: "We are meeting our friends tomorrow evening.", tense: "Presente continuo para el futuro" },
            { sentence: "They have lived here for ten years.", tense: "Pasado participio" },
            { sentence: "He was watching TV when I called him.", tense: "Pasado continuo del verbo to be" },
            { sentence: "I bought a new phone last week.", tense: "Pasado simple" },
            { sentence: "Would you like some coffee?", tense: "Verbo modal: would" },
            { sentence: "Are you listening to me?", tense: "Presente continuo del verbo to be" },
            { sentence: "She is traveling to Japan next month.", tense: "Presente continuo para el futuro" },
            { sentence: "Have you ever been to London?", tense: "Pasado participio" },
            { sentence: "They were playing football when it started to rain.", tense: "Pasado continuo del verbo to be" },
            { sentence: "Did you finish your homework?", tense: "Pasado simple" },
            { sentence: "We would not do that if we were you.", tense: "Verbo modal: would" },
            { sentence: "Is he working today?", tense: "Presente continuo del verbo to be" },
            { sentence: "I am visiting my grandparents this weekend.", tense: "Presente continuo para el futuro" }
        ];
        
        // Inicialización del juego
        document.addEventListener('DOMContentLoaded', function() {
            // Seleccionar 40 oraciones aleatorias para la sección de corrección
            correctionQuestions = getRandomItems(correctionSentences, 40);
            
            // Mezclar las oraciones de identificación
            identificationQuestions = shuffleArray([...identificationSentences]);
            
            // Inicializar elementos del DOM
            initDOMElements();
            
            // Mostrar la primera pregunta de corrección
            showCorrectionQuestion();
            
            // Preparar el juego de pares
            preparePairsGame();
        });
        
        // Función para obtener elementos aleatorios de un array
        function getRandomItems(array, n) {
            const shuffled = shuffleArray([...array]);
            return shuffled.slice(0, n);
        }
        
        // Función para mezclar un array
        function shuffleArray(array) {
            const newArray = [...array];
            for (let i = newArray.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [newArray[i], newArray[j]] = [newArray[j], newArray[i]];
            }
            return newArray;
        }
        
        // Inicializar elementos del DOM
        function initDOMElements() {
            // Botones de sección
            document.getElementById('btn-correction').addEventListener('click', () => switchSection('correction'));
            document.getElementById('btn-identification').addEventListener('click', () => switchSection('identification'));
            document.getElementById('btn-pairs').addEventListener('click', () => switchSection('pairs'));
            
            // Botones de corrección
            document.getElementById('check-correction').addEventListener('click', checkCorrection);
            document.getElementById('next-correction').addEventListener('click', nextCorrectionQuestion);
            document.getElementById('correction-input').addEventListener('keyup', function(e) {
                if (e.key === 'Enter') {
                    checkCorrection();
                }
            });
            
            // Validación en tiempo real del campo de corrección
            document.getElementById('correction-input').addEventListener('input', function() {
                validateCorrectionInput();
            });
            
            // Botones de identificación
            document.getElementById('check-identification').addEventListener('click', checkIdentification);
            document.getElementById('next-identification').addEventListener('click', nextIdentificationQuestion);
            
            // Botones de pares
            document.getElementById('start-pairs').addEventListener('click', startPairsGame);
            
            // Botón de reinicio
            document.getElementById('restart-game').addEventListener('click', restartGame);
        }
        
        // Validar campo de corrección
        function validateCorrectionInput() {
            const input = document.getElementById('correction-input');
            const errorElement = document.getElementById('input-error');
            const value = input.value.trim();
            
            // Limpiar estado de error
            input.classList.remove('error');
            errorElement.style.display = 'none';
            errorElement.textContent = '';
            
            // Validar que no esté vacío
            if (value === '') {
                input.classList.add('error');
                errorElement.textContent = 'Por favor, escribe una respuesta';
                errorElement.style.display = 'block';
                return false;
            }
            
            // Validar longitud mínima
            if (value.length < 3) {
                input.classList.add('error');
                errorElement.textContent = 'La respuesta es demasiado corta';
                errorElement.style.display = 'block';
                return false;
            }
            
            // Validar que tenga al menos un verbo (detectando palabras comunes)
            const words = value.toLowerCase().split(' ');
            const commonVerbs = ['am', 'is', 'are', 'was', 'were', 'have', 'has', 'had', 'do', 'does', 'did', 'will', 'would', 'can', 'could', 'should', 'may', 'might'];
            const hasVerb = words.some(word => commonVerbs.includes(word) || 
                word.endsWith('ing') || 
                word.endsWith('ed') || 
                word.endsWith('s') || 
                word.endsWith('es'));
            
            if (!hasVerb) {
                input.classList.add('error');
                errorElement.textContent = 'La respuesta debe contener un verbo';
                errorElement.style.display = 'block';
                return false;
            }
            
            // Validar que termine con signo de puntuación
            const lastChar = value[value.length - 1];
            if (!['.', '?', '!'].includes(lastChar)) {
                input.classList.add('error');
                errorElement.textContent = 'La oración debe terminar con un signo de puntuación (. ? !)';
                errorElement.style.display = 'block';
                return false;
            }
            
            return true;
        }
        
        // Cambiar entre secciones
        function switchSection(section) {
            // Actualizar botones de sección
            document.querySelectorAll('.section-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            document.getElementById(`btn-${section}`).classList.add('active');
            
            // Ocultar todas las secciones
            document.querySelectorAll('.game-section').forEach(sec => {
                sec.classList.remove('active');
            });
            
            // Mostrar la sección seleccionada
            document.getElementById(`${section}-section`).classList.add('active');
            
            // Actualizar la sección actual
            currentSection = section;
            
            // Si es la sección de identificación y no se ha completado la de corrección, mostrar mensaje
            if (section === 'identification' && !correctionCompleted) {
                alert('Debes completar la sección de corrección primero');
                switchSection('correction');
                return;
            }
            
            // Si es la sección de pares y no se ha completado la de identificación, mostrar mensaje
            if (section === 'pairs' && !identificationCompleted) {
                alert('Debes completar la sección de identificación primero');
                switchSection('identification');
                return;
            }
            
            // Si es la sección de identificación y es la primera vez, mostrar la primera pregunta
            if (section === 'identification' && currentIdentificationQuestion === 0) {
                showIdentificationQuestion();
            }
        }
        
        // Mostrar pregunta de corrección
        function showCorrectionQuestion() {
            const question = correctionQuestions[currentCorrectionQuestion];
            document.getElementById('error-sentence').textContent = question.sentence;
            document.getElementById('hint').textContent = `Pista: ${question.hint}`;
            document.getElementById('correction-input').value = '';
            document.getElementById('correction-feedback').style.display = 'none';
            document.getElementById('correction-current').textContent = currentCorrectionQuestion + 1;
            
            // Limpiar errores de validación
            document.getElementById('correction-input').classList.remove('error');
            document.getElementById('input-error').style.display = 'none';
            document.getElementById('input-error').textContent = '';
            
            // Habilitar/deshabilitar botones
            document.getElementById('check-correction').disabled = false;
            document.getElementById('next-correction').disabled = true;
            document.getElementById('correction-input').focus();
        }
        
        // Comprobar corrección
        function checkCorrection() {
            // Primero validar el campo de entrada
            if (!validateCorrectionInput()) {
                // Mostrar mensaje de error si la validación falla
                document.getElementById('input-error').style.display = 'block';
                return;
            }
            
            const userAnswer = document.getElementById('correction-input').value.trim();
            const correctAnswer = correctionQuestions[currentCorrectionQuestion].correct;
            const feedback = document.getElementById('correction-feedback');
            
            // Verificar si la respuesta es correcta (permitiendo variaciones menores en puntuación)
            const normalizedUserAnswer = userAnswer.toLowerCase().replace(/[.,!?;:]/g, '').trim();
            const normalizedCorrectAnswer = correctAnswer.toLowerCase().replace(/[.,!?;:]/g, '').trim();
            
            if (normalizedUserAnswer === normalizedCorrectAnswer) {
                feedback.textContent = '¡Correcto!';
                feedback.className = 'feedback correct';
                correctionScore++;
            } else {
                feedback.textContent = `Incorrecto. La respuesta correcta es: "${correctAnswer}"`;
                feedback.className = 'feedback incorrect';
            }
            
            feedback.style.display = 'block';
            
            // Habilitar el botón siguiente
            document.getElementById('next-correction').disabled = false;
            document.getElementById('check-correction').disabled = true;
            
            // Desplazar la vista hacia el feedback
            feedback.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        }
        
        // Siguiente pregunta de corrección
        function nextCorrectionQuestion() {
            currentCorrectionQuestion++;
            
            if (currentCorrectionQuestion < correctionQuestions.length) {
                showCorrectionQuestion();
            } else {
                // Sección de corrección completada
                correctionCompleted = true;
                document.getElementById('btn-identification').disabled = false;
                document.getElementById('btn-identification').classList.add('enabled');
                alert('¡Sección de corrección completada! Ahora puedes pasar a la sección de identificación.');
                switchSection('identification');
            }
        }
        
        // Mostrar pregunta de identificación
        function showIdentificationQuestion() {
            const question = identificationQuestions[currentIdentificationQuestion];
            document.getElementById('identification-sentence').textContent = question.sentence;
            document.getElementById('identification-current').textContent = currentIdentificationQuestion + 1;
            
            // Mezclar los tiempos verbales para las opciones
            const shuffledTenses = shuffleArray([...verbTenses]);
            const choicesContainer = document.getElementById('choices-container');
            choicesContainer.innerHTML = '';
            
            // Crear las opciones
            shuffledTenses.forEach(tense => {
                const choice = document.createElement('div');
                choice.className = 'choice';
                choice.textContent = tense;
                choice.dataset.tense = tense;
                choice.addEventListener('click', () => selectChoice(choice));
                choicesContainer.appendChild(choice);
            });
            
            // Reiniciar estado
            selectedChoice = null;
            document.getElementById('check-identification').disabled = true;
            document.getElementById('next-identification').disabled = true;
            document.getElementById('identification-feedback').style.display = 'none';
            
            // Habilitar botones de opción
            enableChoices(true);
        }
        
        // Seleccionar una opción
        function selectChoice(choice) {
            // Deseleccionar todas las opciones
            document.querySelectorAll('.choice').forEach(c => {
                c.classList.remove('selected');
            });
            
            // Seleccionar la opción clickeada
            choice.classList.add('selected');
            selectedChoice = choice.dataset.tense;
            
            // Habilitar el botón de comprobar
            document.getElementById('check-identification').disabled = false;
        }
        
        // Habilitar/deshabilitar opciones
        function enableChoices(enabled) {
            document.querySelectorAll('.choice').forEach(choice => {
                if (enabled) {
                    choice.style.pointerEvents = 'auto';
                    choice.style.opacity = '1';
                } else {
                    choice.style.pointerEvents = 'none';
                }
            });
        }
        
        // Comprobar identificación
        function checkIdentification() {
            const correctTense = identificationQuestions[currentIdentificationQuestion].tense;
            const feedback = document.getElementById('identification-feedback');
            
            // Marcar la respuesta correcta
            document.querySelectorAll('.choice').forEach(choice => {
                if (choice.dataset.tense === correctTense) {
                    choice.classList.add('correct-choice');
                }
            });
            
            // Verificar si la respuesta es correcta
            if (selectedChoice === correctTense) {
                feedback.textContent = '¡Correcto!';
                feedback.className = 'feedback correct';
                identificationScore++;
            } else {
                feedback.textContent = `Incorrecto. El tiempo verbal correcto es: "${correctTense}"`;
                feedback.className = 'feedback incorrect';
                
                // Marcar la respuesta incorrecta del usuario
                if (selectedChoice) {
                    document.querySelector(`.choice[data-tense="${selectedChoice}"]`).classList.add('incorrect-choice');
                }
            }
            
            feedback.style.display = 'block';
            
            // Deshabilitar opciones y botón de comprobar
            enableChoices(false);
            document.getElementById('check-identification').disabled = true;
            document.getElementById('next-identification').disabled = false;
            
            // Desplazar la vista hacia el feedback
            feedback.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        }
        
        // Siguiente pregunta de identificación
        function nextIdentificationQuestion() {
            currentIdentificationQuestion++;
            
            if (currentIdentificationQuestion < identificationQuestions.length) {
                showIdentificationQuestion();
            } else {
                // Sección de identificación completada
                identificationCompleted = true;
                document.getElementById('btn-pairs').disabled = false;
                document.getElementById('btn-pairs').classList.add('enabled');
                alert('¡Sección de identificación completada! Ahora puedes pasar al juego de pares.');
                switchSection('pairs');
            }
        }
        
        // Preparar juego de pares
        function preparePairsGame() {
            // Crear un array con todas las frases (español e inglés)
            let allPhrases = [];
            futurePhrases.forEach(pair => {
                allPhrases.push({ text: pair[0], language: 'es', match: pair[1] });
                allPhrases.push({ text: pair[1], language: 'en', match: pair[0] });
            });
            
            // Mezclar las frases
            allPhrases = shuffleArray(allPhrases);
            
            // Crear las cartas
            const pairsContainer = document.getElementById('pairs-container');
            pairsContainer.innerHTML = '';
            
            allPhrases.forEach((phrase, index) => {
                const card = document.createElement('div');
                card.className = 'card';
                card.dataset.index = index;
                card.dataset.text = phrase.text;
                card.dataset.language = phrase.language;
                card.dataset.match = phrase.match;
                card.textContent = '?';
                
                card.addEventListener('click', () => flipCard(card));
                pairsContainer.appendChild(card);
            });
        }
        
        // Voltear carta
        function flipCard(card) {
            // Si el juego no ha empezado o la carta ya está volteada o emparejada, no hacer nada
            if (!gameStarted || card.classList.contains('flipped') || card.classList.contains('matched') || flippedCards.length >= 2) {
                return;
            }
            
            // Voltear la carta
            card.classList.add('flipped');
            card.textContent = card.dataset.text;
            flippedCards.push(card);
            
            // Si hay dos cartas volteadas, comprobar si son pareja
            if (flippedCards.length === 2) {
                const card1 = flippedCards[0];
                const card2 = flippedCards[1];
                
                // Comprobar si las cartas son pareja
                if ((card1.dataset.text === card2.dataset.match && card2.dataset.text === card1.dataset.match) ||
                    (card1.dataset.match === card2.dataset.text && card2.dataset.match === card1.dataset.text)) {
                    // Son pareja
                    setTimeout(() => {
                        card1.classList.add('matched');
                        card2.classList.add('matched');
                        card1.classList.remove('flipped');
                        card2.classList.remove('flipped');
                        flippedCards = [];
                        matchedPairs++;
                        document.getElementById('pairs-found').textContent = matchedPairs;
                        pairsScore = matchedPairs;
                        
                        // Comprobar si se han encontrado todos los pares
                        if (matchedPairs === 10) {
                            endPairsGame(true);
                        }
                    }, 500);
                } else {
                    // No son pareja, voltearlas de nuevo después de un segundo
                    setTimeout(() => {
                        card1.classList.remove('flipped');
                        card2.classList.remove('flipped');
                        card1.textContent = '?';
                        card2.textContent = '?';
                        flippedCards = [];
                    }, 1000);
                }
            }
        }
        
        // Iniciar juego de pares
        function startPairsGame() {
            gameStarted = true;
            matchedPairs = 0;
            timeLeft = 240; // 4 minutos = 240 segundos
            flippedCards = [];
            
            // Actualizar UI
            document.getElementById('start-pairs').disabled = true;
            document.getElementById('start-pairs').textContent = 'Juego en curso';
            document.getElementById('pairs-found').textContent = '0';
            document.getElementById('timer').textContent = '04:00';
            
            // Iniciar temporizador
            timerInterval = setInterval(() => {
                timeLeft--;
                const minutes = Math.floor(timeLeft / 60);
                const seconds = timeLeft % 60;
                document.getElementById('timer').textContent = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
                
                // Comprobar si se acabó el tiempo
                if (timeLeft <= 0) {
                    endPairsGame(false);
                }
            }, 1000);
        }
        
        // Finalizar juego de pares
        function endPairsGame(completed) {
            clearInterval(timerInterval);
            gameStarted = false;
            pairsCompleted = true;
            
            // Mostrar todas las cartas
            document.querySelectorAll('.card').forEach(card => {
                card.classList.add('flipped');
                card.textContent = card.dataset.text;
            });
            
            // Mostrar mensaje
            if (completed) {
                const totalSeconds = 240 - timeLeft;
                const minutes = Math.floor(totalSeconds / 60);
                const seconds = totalSeconds % 60;
                alert(`¡Felicidades! Has encontrado todos los pares en ${minutes}:${seconds.toString().padStart(2, '0')} minutos.`);
            } else {
                alert(`¡Se acabó el tiempo! Has encontrado ${matchedPairs} pares de 10.`);
            }
            
            // Calcular puntuación final y mostrar resultados
            calculateFinalScore();
        }
        
        // Calcular puntuación final
        function calculateFinalScore() {
            // Calcular puntuación de cada sección
            const correctionPercentage = (correctionScore / 40) * 100;
            const identificationPercentage = (identificationScore / 15) * 100;
            const pairsPercentage = (pairsScore / 10) * 100;
            
            // Calcular puntuación total (ponderada)
            const totalScore = (correctionPercentage * 0.5) + (identificationPercentage * 0.3) + (pairsPercentage * 0.2);
            
            // Calcular calificación del 1 al 10
            const grade = (totalScore / 10).toFixed(1);
            
            // Mostrar resultados
            document.getElementById('correction-score').textContent = `${correctionScore}/40`;
            document.getElementById('identification-score').textContent = `${identificationScore}/15`;
            document.getElementById('pairs-score').textContent = `${pairsScore}/10`;
            document.getElementById('final-score').textContent = Math.round(totalScore);
            document.getElementById('final-grade').textContent = grade;
            
            // Mostrar sección de resultados
            document.getElementById('results-section').classList.add('active');
            document.getElementById('pairs-section').classList.remove('active');
        }
        
        // Reiniciar juego
        function restartGame() {
            // Reiniciar variables
            currentSection = 'correction';
            correctionScore = 0;
            identificationScore = 0;
            pairsScore = 0;
            currentCorrectionQuestion = 0;
            currentIdentificationQuestion = 0;
            selectedChoice = null;
            correctionCompleted = false;
            identificationCompleted = false;
            pairsCompleted = false;
            flippedCards = [];
            matchedPairs = 0;
            gameStarted = false;
            timeLeft = 240; // 4 minutos
            
            // Detener temporizador
            if (timerInterval) {
                clearInterval(timerInterval);
            }
            
            // Seleccionar nuevas oraciones aleatorias
            correctionQuestions = getRandomItems(correctionSentences, 40);
            identificationQuestions = shuffleArray([...identificationSentences]);
            
            // Reiniciar UI
            document.getElementById('btn-identification').disabled = true;
            document.getElementById('btn-identification').classList.remove('enabled');
            document.getElementById('btn-pairs').disabled = true;
            document.getElementById('btn-pairs').classList.remove('enabled');
            document.getElementById('start-pairs').disabled = false;
            document.getElementById('start-pairs').textContent = 'Comenzar Juego';
            document.getElementById('timer').textContent = '04:00';
            
            // Ocultar resultados
            document.getElementById('results-section').classList.remove('active');
            
            // Mostrar primera sección
            switchSection('correction');
            showCorrectionQuestion();
            
            // Preparar juego de pares nuevamente
            preparePairsGame();
        }
    </script>
</body>
</html>